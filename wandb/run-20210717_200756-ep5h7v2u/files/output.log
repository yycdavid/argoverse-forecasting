Training begins ...
2021-07-17 20:08:11.673515: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2021-07-17 20:08:11.674462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-07-17 20:08:11.674635: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/home/jasonyma/.mujoco/mujoco200/bin:/home/jasonyma/.mujoco/mujoco200/bin
2021-07-17 20:08:11.677034: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-07-17 20:08:11.679107: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-07-17 20:08:11.679460: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-07-17 20:08:11.682179: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-07-17 20:08:11.684008: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-07-17 20:08:11.684199: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/home/jasonyma/.mujoco/mujoco200/bin:/home/jasonyma/.mujoco/mujoco200/bin
2021-07-17 20:08:11.684211: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-07-17 20:08:11.684821: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-17 20:08:11.727543: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2400000000 Hz
2021-07-17 20:08:11.736979: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55aa58411cc0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-17 20:08:11.737024: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-17 20:08:11.737199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-17 20:08:11.737217: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
Train -- Epoch:0, loss:7.090463161468506, Rollout:30
Training epoch completed in 7.036397858460744 mins, Total time: 7.037797439098358 mins
Training epoch completed in 12.444425690174103 mins, Total time: 19.48222500483195 mins
Train -- Epoch:2, loss:5.756855487823486, Rollout:30
Training epoch completed in 12.38947273492813 mins, Total time: 31.871699396769205 mins
Training epoch completed in 11.782996153831482 mins, Total time: 43.654697072505954 mins
Train -- Epoch:4, loss:5.722305774688721, Rollout:30
Training epoch completed in 11.372130839029948 mins, Total time: 55.0268320997556 mins
Traceback (most recent call last):
  File "lstm_prog_train_test.py", line 1094, in <module>
    main()
  File "lstm_prog_train_test.py", line 1047, in main
    False,
  File "lstm_prog_train_test.py", line 583, in validate
    cls_encoder_hidden = cls_encoder(cls_encoder_input, cls_encoder_hidden)
  File "/home/jasonyma/anaconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/jasonyma/anaconda3/lib/python3.7/site-packages/torch/nn/parallel/data_parallel.py", line 153, in forward
    return self.module(*inputs[0], **kwargs[0])
  File "/home/jasonyma/anaconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "lstm_prog_train_test.py", line 178, in forward
    hidden = self.lstm1(embedded, hidden)
  File "/home/jasonyma/anaconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/jasonyma/anaconda3/lib/python3.7/site-packages/torch/nn/modules/rnn.py", line 969, in forward
    self.bias_ih, self.bias_hh,
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 10.76 GiB total capacity; 9.63 GiB already allocated; 17.25 MiB free; 9.63 GiB reserved in total by PyTorch)
